#Riemann Main Result J(x) = Li(x) - SUM Li(x^p) - log2 - integral 1/(t(t^2-1)*logt)
#p328
#p349 conclusions
#note: Li(x^p) should be considered as Ei(p*log(x)), see https://en.wikipedia.org/wiki/Prime-counting_function#Formulas_for_prime-counting_functions
#http://cran.r-project.org/web/packages/numbers/numbers.pdf
#https://cran.r-project.org/web/packages/pracma/pracma.pdf
#install.packages("numbers")
#install.packages("pracma")
library(numbers)
library(pracma)

π <- function(x){
  if(!x%%1==0){
    return (length(Primes(floor(x))))
  }
  else{
    if(length(Primes(floor(x))) == length(Primes(floor(x-1))))
      return (length(Primes(floor(x))))       
    else
      return (length(Primes(floor(x))) - 1/2)
  }
}

Jusingπ <- function(x) {
  t <- 1
  y <- 0
  while(x^(1/t) >= 2){
    y <- y + 1/t*π(x^(1/t))
    t <- t+1
  }
  return (y)
}

#1000 zeta zeros imaginary part http://www.dtc.umn.edu/~Odlyzko/zeta_tables/zeros1
pimg <- c(14.13472514,21.02203964,25.01085758,30.42487613,32.93506159,37.58617816,40.91871901,43.32707328,48.00515088,49.77383248,52.97032148,56.4462477,59.347044,60.83177853,65.11254405,67.07981053,69.54640171,72.06715767,75.7046907,77.14484007,79.33737502,82.91038085,84.73549298,87.42527461,88.80911121,92.49189927,94.65134404,95.87063423,98.83119422,101.317851,103.725538,105.4466231,107.1686112,111.0295355,111.8746592,114.3202209,116.2266803,118.7907829,121.370125,122.9468293,124.2568186,127.5166839,129.5787042,131.0876885,133.4977372,134.7565098,138.1160421,139.736209,141.1237074,143.1118458,146.0009825,147.4227653,150.0535204,150.9252576,153.0246938,156.1129093,157.5975918,158.8499882,161.1889641,163.0307097,165.5370692,167.18444,169.0945154,169.9119765,173.4115365,174.7541915,176.4414343,178.3774078,179.916484,182.2070785,184.8744678,185.5987837,187.2289226,189.4161587,192.0266564,193.0797266,195.2653967,196.8764818,198.0153097,201.2647519,202.4935945,204.1896718,205.3946972,207.9062589,209.5765097,211.6908626,213.3479194,214.5470448,216.1695385,219.0675963,220.7149188,221.4307056,224.0070003,224.9833247,227.4214443,229.3374133,231.2501887,231.9872353,233.6934042,236.5242297,237.7698205,239.5554776,241.0491578,242.8232719,244.0708985,247.1369901,248.1019901,249.5736896,251.0149478,253.0699867,255.3062565,256.3807137,258.6104395,259.874407,260.8050845,263.5738939,265.5578518,266.6149738,267.9219151,269.970449,271.4940556,273.4596092,275.5874926,276.4520495,278.2507435,279.2292509,282.4651148,283.2111857,284.835964,286.6674454,287.9119205,289.5798549,291.8462913,293.5584341,294.9653696,295.5732549,297.9792771,299.8403261,301.6493255,302.6967496,304.8643713,305.7289126,307.2194961,310.1094631,311.1651415,312.4278012,313.9852857,315.4756161,317.7348059,318.8531043,321.1601343,322.1445587,323.4669696,324.8628661,327.4439013,329.0330717,329.9532397,331.4744676,333.6453785,334.2113548,336.8418504,338.3399929,339.8582167,341.0422611,342.0548775,344.6617029,346.3478706,347.2726776,349.3162609,350.4084193,351.878649,353.4889005,356.017575,357.1513023,357.9526851,359.743755,361.2893617,363.3313306,364.7360241,366.2127103,367.9935755,368.9684381,370.0509192,373.0619284,373.8648739,375.8259128,376.3240922,378.4366803,379.8729753,381.4844686,383.4435295,384.9561168,385.8613008,387.2228902,388.8461284,391.4560836,392.2450833,393.4277438,395.58287,396.3818542,397.9187362,399.9851199,401.8392286,402.8619178,404.2364418,405.1343875,407.5814604,408.9472455,410.5138692,411.9722678,413.2627361,415.0188098,415.455215,418.3877058,419.8613648,420.6438276,422.0767101,423.7165796,425.0698825,427.2088251,428.1279141,430.3287454,431.3013069,432.1386417,433.8892185,436.1610064,437.5816982,438.6217387,439.9184422,441.6831992,442.9045463,444.3193363,446.8606227,447.4417042,449.1485457,450.1269458,451.4033084,453.9867378,454.9746838,456.3284267,457.9038931,459.5134153,460.0879444,462.0653673,464.0572869,465.6715392,466.5702869,467.4390462,469.5360046,470.7736555,472.7991747,473.8352323,475.6003394,476.7690152,478.0752638,478.9421815,481.8303394,482.8347828,483.8514272,485.5391481,486.5287183,488.3805671,489.6617616,491.3988216,493.3144416,493.9579978,495.3588288,496.4296962,498.5807824,500.3090849,501.604447,502.2762703,504.4997733,505.4152317,506.4641527,508.8007003,510.2642279,511.5622897,512.6231445,513.6689856,515.4350572,517.5896686,518.2342231,520.1063104,521.5251934,522.4566962,523.9605309,525.0773857,527.9036416,528.4062139,529.8062263,530.8669179,532.688183,533.7796308,535.6643141,537.0697591,538.4285262,540.2131664,540.6313902,541.8474371,544.3238901,545.6368332,547.0109121,547.9316134,549.4975676,550.97001,552.0495722,553.7649721,555.7920206,556.8994764,557.5646592,559.316237,560.2408075,562.5592076,564.1608791,564.5060559,566.6987877,567.7317579,568.9239552,570.0511148,572.4199841,573.6146105,575.093886,575.8072471,577.0390035,579.0988347,580.1369594,581.9465763,583.2360882,584.5617059,585.9845632,586.7427719,588.1396633,590.6603975,591.7258581,592.5713583,593.9747147,595.7281537,596.3627683,598.4930773,599.5456404,601.6021367,602.5791679,603.6256189,604.6162185,606.3834604,608.4132173,609.3895752,610.8391629,611.7742096,613.5997787,614.6462379,615.5385634,618.1128314,619.1844826,620.2728937,621.7092945,622.3750027,624.2699,626.0192834,627.2683969,628.3258624,630.4738874,630.8057809,632.2251412,633.5468583,635.5238003,637.3971932,637.925514,638.9279383,640.6947947,641.9454997,643.2788838,644.9905782,646.3481916,647.761753,648.7864009,650.1975193,650.6686839,653.6495716,654.3019206,655.709463,656.9640846,658.1756144,659.663846,660.7167326,662.2965864,664.2446047,665.3427631,666.5151477,667.1484949,668.9758488,670.3235852,672.4581836,673.0435783,674.3558978,676.1396744,677.2301807,677.8004447,679.7421979,681.8949915,682.602735,684.0135498,684.9726299,686.1632236,687.9615432,689.3689414,690.474735,692.4516844,693.1769701,694.5339087,695.7263359,696.6260699,699.1320955,700.2967391,701.301743,702.2273431,704.0338393,705.125814,706.1846548,708.2690709,709.2295886,711.1302742,711.9002899,712.7493835,714.0827718,716.1123965,717.4825697,718.7427865,719.697101,721.3511622,722.277505,723.845821,724.5626139,727.0564032,728.4054816,728.7587498,730.4164821,731.4173549,732.8180527,734.7896433,735.7654592,737.0529289,738.5804212,739.9095237,740.5738074,741.7573356,743.8950131,745.3449896,746.4993059,747.6745636,748.2427545,750.6559504,750.9663811,752.8876216,754.3223705,755.839309,756.7682484,758.1017292,758.9002382,760.282367,762.7000333,763.5930662,764.3075227,766.0875401,767.2184722,768.2814618,769.6934073,771.0708393,772.9616176,774.1177446,775.0478471,775.999712,777.2997485,779.1570769,780.348925,782.1376644,782.5979439,784.2888226,785.7390897,786.4611475,787.4684638,790.0590924,790.8316205,792.4277076,792.8886526,794.4837919,795.6065962,797.26347,798.7075702,799.6543362,801.6042465,802.5419849,803.2430962,804.7622391,805.8616357,808.1518149,809.1977834,810.0818049,811.1843588,812.7711084,814.0459136,814.8705396,816.7277377,818.3806689,819.2046422,820.7218984,821.7134541,822.1977575,824.5262939,826.0392874,826.905811,828.3401743,829.437011,830.8958841,831.7997777,833.0036409,834.6519151,836.6935762,837.3473351,838.249022,839.4653948,841.0363898,842.0413542,844.1661966,844.805994,846.1947699,847.9717176,848.4892812,849.8622743,850.6454485,853.1631126,854.0955117,855.2867102,856.4841175,857.3107406,858.9040265,860.4106709,861.1710982,863.1897198,864.3408239,865.5946643,866.4237399,867.6931226,868.6704942,870.8469023,872.1887508,873.098979,873.9083892,875.9852851,876.6008258,877.6546983,879.380952,880.8346488,882.3866966,883.4303318,884.1987431,885.2723045,886.852802,888.4755667,889.7352943,890.8131321,892.3864333,893.1191176,894.8862923,895.3979197,896.6322516,899.2215227,899.8588846,900.8497399,902.2432076,903.0996744,904.7029027,905.8299408,907.6567295,908.3335436,910.1863341,911.2349515,912.3310456,912.8239992,914.730097,916.3550008,917.8253776,918.8365352,919.4483444,921.1563955,922.5006293,923.2857198,924.7734839,926.5515528,927.850859,928.6636593,929.8740929,931.0092113,931.8527407,934.3853068,934.9954249,936.2286494,937.5329257,939.0243009,939.6609406,941.1569996,942.0523416,944.1880358,945.3335625,946.7658422,947.0791831,948.3466463,950.1516127,951.0332487,952.7279886,954.1297193,954.8293089,956.6754793,957.5100526,958.4145934,959.4591688,961.6695725,963.1820867,963.5670402,965.0555796,966.1107548,967.3711538,968.6363019,970.1256106,971.0714915,973.1853613,973.873079,974.7746351,976.1785024,976.9172021,978.7666715,980.5780006,981.2886153,982.3964852,983.575076,985.1869287,986.1305151,986.7560084,988.9926224,990.2239178,991.3742941,992.7286963,993.214581,994.4045906,996.2053362,997.5119348,998.8275471,999.7915716,1001.349483,1002.404305,1003.267808,1004.675044,1005.54342,1008.006704,1008.79571,1009.806591,1010.569757,1012.410043,1013.058638,1014.689633,1016.060179,1017.266402,1018.605573,1019.91244,1020.917475,1021.544345,1022.885271,1025.265724,1025.707944,1027.467694,1028.128964,1029.227297,1030.897369,1031.83318,1032.812883,1034.612916,1036.195917,1037.024708,1038.087752,1039.077401,1040.264038,1041.621528,1043.623954,1044.514976,1045.107042,1047.089817,1047.987147,1048.953785,1049.996284,1051.576572,1053.245785,1054.781039,1055.002146,1056.688847,1057.100044,1059.133769,1060.139519,1061.501304,1062.915382,1064.071551,1065.121855,1066.463223,1067.41886,1067.99,1070.535042,1071.618623,1072.543998,1073.570353,1074.747771,1076.266626,1076.924056,1078.647198,1079.809965,1081.171002,1082.95275,1083.295467,1084.183264,1085.647831,1086.911999,1088.755725,1089.795338,1090.863191,1091.728473,1093.440873,1094.284458,1095.433085,1096.401918,1098.841015,1099.360667,1100.574461,1101.839111,1102.55178,1103.732297,1105.617189,1106.774372,1107.774532,1109.158919,1110.444143,1111.443505,1112.432995,1113.397595,1115.065359,1116.787254,1117.96592,1118.684135,1119.473247,1121.155938,1122.458621,1123.101117,1125.314729,1125.763442,1127.658024,1128.430225,1129.728997,1130.391598,1131.495086,1133.708626,1134.885655,1135.562214,1136.929293,1138.15159,1138.992342,1140.721848,1141.261023,1142.85866,1144.7823,1145.485328,1146.576815,1147.501777,1148.615277,1149.982601,1151.562815,1152.943129,1153.890304,1154.69752,1156.621568,1157.432315,1158.001609,1159.480657,1161.396645,1162.487529,1163.701032,1164.737586,1165.271228,1166.943613,1168.086272,1169.698357,1170.463639,1172.120682,1173.305688,1174.232767,1175.215452,1176.632876,1177.106304,1179.701224,1180.653544,1181.267318,1182.58227,1183.712775,1185.155843,1185.875359,1187.345161,1188.856444,1189.963636,1191.482606,1192.218611,1193.324021,1193.857427,1196.034672,1197.071787,1198.686569,1199.356514,1200.532692,1201.810335,1203.137351,1203.855248,1204.985492,1206.8705,1208.47146,1208.989484,1209.89803,1211.416116,1212.113153,1213.598373,1215.389975,1216.183722,1217.174482,1219.050028,1219.614471,1220.816348,1221.692242,1222.952484,1225.01833,1225.855021,1227.231828,1227.917142,1228.793154,1230.584603,1231.562274,1232.529587,1234.277817,1235.502549,1236.399017,1237.977299,1238.457233,1239.490807,1240.813472,1243.078076,1243.538147,1244.851434,1245.655866,1247.372562,1248.063061,1249.159888,1250.672397,1251.659832,1253.673578,1254.431328,1255.408231,1256.181214,1257.541219,1258.779233,1260.344548,1261.611717,1262.556614,1263.676733,1264.957223,1266.179038,1267.200346,1267.570572,1270.118922,1271.1343,1272.08396,1273.261145,1274.196221,1275.09203,1276.842172,1277.763092,1279.332843,1280.155794,1281.828727,1283.000491,1283.335032,1284.854795,1285.695023,1287.410027,1289.165352,1290.104772,1290.417708,1291.945871,1293.493982,1294.118474,1295.365364,1296.801111,1298.256527,1299.405171,1300.490019,1301.495517,1302.346742,1303.2732,1305.401672,1306.508393,1307.267242,1308.988197,1309.421532,1311.056571,1311.966941,1313.031599,1314.052566,1316.212113,1317.072986,1318.171279,1318.947881,1319.931083,1321.628139,1322.258067,1324.224979,1325.237624,1325.98197,1327.635281,1329.043518,1329.205019,1330.429937,1331.827591,1333.673523,1334.747329,1335.694975,1336.690185,1337.688792,1338.923165,1340.4264,1341.166272,1342.608508,1344.156044,1345.477106,1345.731413,1347.519472,1348.017238,1349.085194,1351.296206,1352.210465,1353.483338,1353.886782,1355.680595,1356.605656,1357.771743,1358.46016,1360.393145,1361.393075,1363.022329,1363.879191,1364.576585,1365.493734,1367.104091,1368.330193,1369.686949,1370.973523,1371.686554,1373.202915,1374.154799,1375.302392,1376.16178,1377.177634,1379.683283,1380.148578,1381.073977,1382.345663,1383.297591,1384.444416,1385.663777,1387.326648,1387.921454,1389.565832,1390.70549,1391.8532,1392.644028,1393.433402,1394.884185,1396.544163,1397.834623,1398.837675,1399.839473,1400.426946,1402.564347,1402.973748,1404.006292,1405.666975,1407.085143,1408.136307,1409.320681,1410.024811,1411.257057,1411.965653,1413.843149,1415.585785,1415.781581,1417.102823,1418.696964,1419.422481)

generatep <- function() {
  zeros <- c()
  for (x in pimg) {
    zeros <- c(zeros, complex(real = 1/2, imaginary = x))
    zeros <- c(zeros, complex(real = 1/2, imaginary = -1*x))
  }
  zeros
}

integrand <- function(x) {1/(x*(x^2-1)*log(x))}

JusingZeros <- function(x,p) {
  #Riemann Main Result (not 100% accurate as only using 1000 zeros)
  li(x) - sum(expint_Ei(p*log(x))) - log(2) + as.numeric(integrate(integrand, lower = x, upper = Inf)[1])
}

x <- seq(1.1,20,by=0.1)
y1 <- sapply(x,Jusingπ)
p <- generatep()
y2 <- sapply(x,JusingZeros,p)
plot(x,y1,type="p", ann=FALSE)
lines(x,y2,col="blue")
title("Riemann Main Result: J(x) in terms of non-trivial zeros of zeta function",xlab="x",ylab="J(x) = Li(x)-SUM(Li(x^p))-log2+integral(1/(t(t^2-1)*logt)) = blue, J(x) = SUM((1/t)*π(x^(1/t))) = black")
